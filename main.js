!function (e) { var t = {}; function a(o) { if (t[o]) return t[o].exports; var i = t[o] = { i: o, l: !1, exports: {} }; return e[o].call(i.exports, i, i.exports, a), i.l = !0, i.exports } a.m = e, a.c = t, a.d = function (e, t, o) { a.o(e, t) || Object.defineProperty(e, t, { enumerable: !0, get: o }) }, a.r = function (e) { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(e, "__esModule", { value: !0 }) }, a.t = function (e, t) { if (1 & t && (e = a(e)), 8 & t) return e; if (4 & t && "object" == typeof e && e && e.__esModule) return e; var o = Object.create(null); if (a.r(o), Object.defineProperty(o, "default", { enumerable: !0, value: e }), 2 & t && "string" != typeof e) for (var i in e) a.d(o, i, function (t) { return e[t] }.bind(null, i)); return o }, a.n = function (e) { var t = e && e.__esModule ? function () { return e.default } : function () { return e }; return a.d(t, "a", t), t }, a.o = function (e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, a.p = "", a(a.s = 0) }([function (e, t, a) { "use strict"; a.r(t), a.d(t, "CrossSellCarWidget", (function () { return b })); const o = { setLocalStorageItem(e, t) { "undefined" != typeof window && void 0 !== window.localStorage && localStorage.setItem(e, JSON.stringify(t)) }, getLocalStorageItem(e) { if ("undefined" != typeof window && void 0 !== window.localStorage) { let t = localStorage.getItem(e); if (void 0 !== t && "undefined" != t && null != t) { return JSON.parse(localStorage.getItem(e)) } } return null } }; var i = { createTemplate(e) { const t = document.createElement("template"); return e = e.trim(), t.innerHTML = e, t }, handleBcdUpdate: function (e, t, a) { let i = o.getLocalStorageItem("GaadiData") || {}, n = t || i.bcdList || []; if (e.key) if (this.isKeyInBcdList(e.key, t)) { let t = n.findIndex(t => t.key == e.key); t >= 0 && n[t] && (n[t].value = e.value, n[t].returnUrl = e.returnUrl, n[t].group = e.group) } else null != a || null != a ? n.splice(a, 0, { value: e.value, key: e.key, returnUrl: e.returnUrl, group: e.group }) : n.push({ value: e.value, key: e.key, returnUrl: e.returnUrl, group: e.group }); return this.updateLocalStorage({ bcdList: n }), n }, updateLocalStorage: function (e) { let t = o.getLocalStorageItem("GaadiData") || {}; t = { ...t, ...e }, o.setLocalStorageItem("GaadiData", t) }, isKeyInBcdList: function (e, t) { let a = o.getLocalStorageItem("GaadiData") || {}, i = t || a.bcdList || [], n = !1; return i.forEach(t => { t.key === e && (n = !0) }), n }, ordinal_suffix_of(e) { var t = e % 10, a = e % 100; return 1 == t && 11 != a ? e + "st" : 2 == t && 12 != a ? e + "nd" : 3 == t && 13 != a ? e + "rd" : e + "th" }, removeBCD(e, t) { let a = e.findIndex(e => e.key == t); return a >= 0 && (e = e.splice(a, 1)), e }, setcitySessionCookie(e) { if (void 0 === e.id || 0 == e.id || "" == e.id) return; this.setCookie("CityId", e.id, 30); let t = this.getCookie("leadForm"); "" != t && void 0 !== t ? (void 0 === t.choices && (t.choices = {}), void 0 === t.formData && (t.formData = {}), t.formData.cityName = e.value, t.formData.cityId = e.id) : t = { choices: {}, formData: { cityName: e.value, cityId: e.id } }, this.setCookie("leadForm", t, 30), o.setLocalStorageItem("citymid", t.formData.cityId) }, setCookie(e, t, a, i, n, r = "Lax") { if (void 0 !== e && void 0 !== t && "function" != typeof t) { "object" == typeof t && (t = JSON.stringify(t)); var s = new Date; s.setTime(s.getTime() + 24 * (a || 30) * 60 * 60 * 1e3); var l = "expires=" + s.toUTCString(); if (document.cookie = `${e}=${n ? encodeURIComponent(t) : t};secure;${i ? "" : l + ";"}path=/;SameSite=${r};`, "CityId" === e) return o.setLocalStorageItem(e, t) } }, getCookie(e, t) { try { var a = []; if (null != t && void 0 !== t && t.length > 0) a = t.split("; "); else if ("undefined" != typeof document) a = document.cookie.split("; "); else if ("undefined" != typeof navigator && !navigator.cookieEnabled && "CityId" === e) return o.getLocalStorageItem("CityId"); for (var i = 0, n = a.length; i < n; i++) { var r = a[i].split("="), s = decodeURIComponent(r.shift()), l = r.join("="); if (e && e === s) { 0 === l.indexOf('"') && (l = l.slice(1, -1).replace(/\\"/g, '"').replace(/\\\\/g, "\\")); try { return l = decodeURIComponent(l.replace(/\+/g, " ")), l = "object" != typeof JSON.parse(l) || Array.isArray(JSON.parse(l)) ? l : JSON.parse(l) } catch (e) { return l } } } } catch (e) { console.log("ERR: Globals.getcookie: ", e.toString()) } return "CityId" === e && o.getLocalStorageItem("CityId") ? o.getLocalStorageItem("CityId") + "" : "" } }; var n = { getApi: e => fetch("https://apib2c.gaadi.com/gaadinew/api/v1/vehicle/registration?" + new URLSearchParams(e), { method: "GET", headers: { "Content-type": "application/json; charset=UTF-8" } }) }; const r = ["MOTOR CAB(LPV)", "GOODS CARRIER(LGV)", "AGRICULTURAL TRACTOR(LMV)", "GOODS CARRIER(HGV)", "OMNI BUS (PRIVATE USE)(LMV)", "ARTICULATED VEHICLE(HGV)", "BUS(HPV)", "EARTH MOVING EQUIPMENT(HGV)", "MAXI CAB(LPV)", "THREE WHEELER (GOODS)(3WT)", "THREE WHEELER (PASSENGER)(3WT)", "OMNI BUS(LMV)", "LUXURY CAB(LPV)", "DUMPER(HGV)", "BUS(LPV)", "AGRICULTURAL TRACTOR(OTH)", "GOODS CARRIER(MGV)", "GOODS CARRIER (HGV)"], s = ["M-Cycle/Scooter(2WN)", "Motor Cycle/Scooter-Used For Hire(2WT)", "Three Wheeler (Goods)(3WT)", "Three Wheeler (Passenger)(3WT)", "Motorised Cycle (CC > 25cc)(2WN)", "MOTOR CYCLE(SCR)", "Moped(2WN)"], l = { events: {}, subscribe: function (e, t) { this.events[e] = this.events[e] || [], this.events[e].push(t) }, unsubscribe: function (e, t) { this.events[e] && (this.events[e] = this.events[e].filter(e => e !== t)) }, publish: function (e, t) { this.events[e] && this.events[e].forEach(e => { e(t) }) } }; let d = ""; class c extends HTMLElement { constructor() { super(); const e = this.attachShadow({ mode: "open" }), t = i.createTemplate('\n    <style>@import url(\'../../../gaadi/webcomponent/sellcar-widget/components/reg-input/reg-input-widget.css\');</style>\n    <div class="bottomContainerForm">\n        <div class="flotingInput">\n            <input class="inputBox form-input" id="inputVal" placeholder="none" name="inputVal" type="text" value="" />\n            <label class="form-label">Enter registration number (DL03 CW 3122)</label>\n        </div>\n        <div class="errorValidation" id="errorValidation"></div>\n        <button type="button" name="checkPrice" class="CTAButton" id="CTAButton">Check Price</button>\n    </div>').content.cloneNode(!0); e.appendChild(t), e.querySelector("#inputVal").value = this.getAttribute("value"), e.querySelector("#inputVal").setAttribute("required", "required"), this.setAttribute("value", d) } connectedCallback() { this.shadowRoot.querySelector("#inputVal").addEventListener("input", e => this.handleRegNo(e)), this.shadowRoot.querySelector("#CTAButton").addEventListener("click", () => this.handleCheckPrice()) } handleRegNo(e) { if (d = this.formatRegNumber(e.target.value), e.target.value = d, this.validateVehicleNo(e.target.value)) return !0 } validateVehicleNo(e) { return !!e && (/^[A-Za-z]{2}[0-9]{1,2}[A-Za-z]{0,3}[0-9]{4}$/.test(e.replace(/\-/g, "")) || /^([0-9]{2}BH[0-9]{1,4}[A-HJ-NP-Z]{1,2})$/.test(e.replace(/\-/g, ""))) } handleCheckPrice() { let e = d; if (this.validateVehicleNo(e)) { let t = e.replace(/\-/g, ""); if (t) { let e = { vehicle_no: t, api_type: 1 }; this.shadowRoot.querySelector("#CTAButton").classList.add("orangeCircle_m"), n.getApi(e).then(e => e.json()).then(e => { if (this.shadowRoot.querySelector("#CTAButton").classList.remove("orangeCircle_m"), e && e.data) { const a = r.map(e => e.toLowerCase().trim()), o = s.map(e => e.toLowerCase().trim()); let i = {}; if (e.data.vehicle_class && a.indexOf(e.data.vehicle_class.toLowerCase().trim()) > -1) return i = { message: "Sorry! We are not purchasing Commercial Cars currently.", registrationNo: t }, void l.publish("gaadi-wc.invalidRegNo", i); if (e.data.vehicle_class && o.indexOf(e.data.vehicle_class.toLowerCase().trim()) > -1) return i = { message: "Sorry! We are not purchasing Two Wheelers currently.", registrationNo: t }, void l.publish("gaadi-wc.invalidRegNo", i); l.publish("gaadi-wc.success", e.data) } }).catch(e => { console.error(e), this.shadowRoot.querySelector("#CTAButton").classList.remove("orangeCircle_m") }) } } else this.shadowRoot.querySelector("#errorValidation").innerHTML = "Please enter valid registration no." } formatRegNumber(e) { let t = []; if ((e = (e = (e = e.replace(/\-/g, "")).replace(/\ /g, "")).toUpperCase()).length > 0) { if ((/^([0-9]{2}B)$/.test(e) || /^([0-9]{2}BH)$/.test(e) || /^([0-9]{2}BH[0-9]{1,4})$/.test(e) || /^([0-9]{2}BH[0-9]{1,4}[A-HJ-NP-Z]{1,2})$/.test(e)) && (t[0] = e.match(/\d{1,2}/)[0], e = e.replace(/\d{1,2}/, ""), t[0] && t[0].length > 0 && e.match(/\D{1,2}/) && e.match(/\D{1,2}/)[0] && (t[1] = e.match(/\D{1,2}/)[0], e = e.replace(/\D{1,2}/, "")), e.match(/\d{1,4}/) && e.match(/\d{1,4}/)[0] && (t.push(e.match(/\d{1,4}/))[0], e = e.replace(/\d{1,4}/, "")), t[1] && t[1].length > 0 && e.length > 0 && e.match(/\D{1,2}/) && e.match(/\D{1,2}/)[0] && (t.push(e.match(/\D{1,2}/))[0], e = e.replace(/\D{1,2}/, ""))), t.length > 0) return t.join("-"); return this.oldRegistrationFormat(e, t) } return "" } oldRegistrationFormat(e, t) { return e.length > 0 && e.match(/\D{1,2}/) && e.match(/\D{1,2}/)[0] && (t[0] = e.match(/\D{1,2}/)[0], e = e.replace(/\D{1,2}/, "")), t[0] && t[0].length > 0 && e.length > 0 && e.match(/\d{1,2}/) && e.match(/\d{1,2}/)[0] && (t[1] = e.match(/\d{1,2}/)[0], e = e.replace(/\d{1,2}/, "")), t[1] && t[1].length > 0 && e.length > 0 && e.match(/\D{1,3}/) && e.match(/\D{1,3}/)[0] && (t.push(e.match(/\D{1,3}/))[0], e = e.replace(/\D{1,3}/, "")), e.length > 0 && e.match(/\d{1,4}/) && e.match(/\d{1,4}/)[0] && (t.push(e.match(/\d{1,4}/))[0], e = e.replace(/\d{1,4}/, "")), t.length > 0 ? t.join("-") : "" } } customElements.define("reg-input-widget", c); class u extends HTMLElement { constructor() { super(), this.attachShadow({ mode: "open" }), this.isVisible = !1, this.render() } render() { const e = `\n            <style>@import url('../../../../gaadi/webcomponent/sellcar-widget/components/pop-up/pop-up-widget.css');</style>\n            <div class="modal ${this.isVisible ? "show-modal" : "hidden"}">\n                <div class="modal-content">\n                    <div class="modelHeaderSection">\n                        <div class="crossButton" id="closeButton">×</div>\n                    </div>\n                    <div class="modelBodySection" id="modelBodySection"></div>\n                </div>\n            </div>`; this.shadowRoot.innerHTML = e } connectedCallback() { this.shadowRoot.querySelector("#closeButton").addEventListener("click", () => this.closeModal()), l.subscribe("gaadi-wc.success", e => this.onRegNumberSuccess(e)), l.subscribe("gaadi-wc.apptdropopen", () => this.openModal()) } onRegNumberSuccess(e) { let t = o.getLocalStorageItem("GaadiData") || {}; e && "" == e.userName && delete e.userName; let a = { ...t, ...e }; a.variantName = a.variant_name, a.variantId = a.variant_id, a.brandImageUrl = a.brand_image_url, a.oemImage = a.brand_image_url, a.bcdList = [], a.owner_count = e.owner_count ? e.owner_count : "", delete a.variant_id, delete a.variant_name, delete a.brand_image_url; let i = ""; o.setLocalStorageItem("GaadiData", a), this.getRedirectionStep(e, e => { const t = o.getLocalStorageItem("GaadiData") || {}; t.step = e, i = e || "/make", o.setLocalStorageItem("GaadiData", t), this.pushBcdDataForReg(), this.openPopupWithStep(i) }) } openModal() { let e = o.getLocalStorageItem("GaadiData") || {}, t = e.step ? e.step : "/make"; this.openPopupWithStep(t) } getIframeTemplates(e, t) { return `<iframe src="${e}" id="${t}" width="100%" height="100%"></iframe>` } openPopupWithStep(e = "") { this.shadowRoot.querySelector(".modal").classList.toggle("show-modal"); let t = this.getIframeTemplates(`http://localhost/sell-used-car${e}?isiframe=1`, "cardekhoiframe"); this.shadowRoot.querySelector(".modelBodySection").innerHTML = t } getRedirectionStep(e, t) { const a = o.getLocalStorageItem("GaadiData") || {}; let i = e.period && e.modelId ? "/variant" : "/make"; "" !== e.variant_id && "" !== e.variant_name ? (o.setLocalStorageItem("GaadiData", a), e.owner_count ? t("/odometer") : t("/ownership")) : t("" + i) } pushBcdDataForReg() { let e = o.getLocalStorageItem("GaadiData"); if (e.make && e.makeId) if (i.handleBcdUpdate({ value: e.make, key: "make", returnUrl: "/make", group: "group1" }, null, 0), e.period) i.handleBcdUpdate({ value: e.period, key: "period", returnUrl: "/period", group: "group1" }, null, 1), e.modelId && i.handleBcdUpdate({ value: e.modelName, key: "model", returnUrl: "/model", group: "group1" }, null, 2), e.variantId && e.variantName && i.handleBcdUpdate({ value: e.variantName, key: "variant", returnUrl: "/variant", group: "group1" }, null, 3), e.owner_count && i.handleBcdUpdate({ value: i.ordinal_suffix_of(e.owner_count) + " owner", key: "owner_count", returnUrl: "/ownership", group: "group1" }, null, 4); else { let t = e.bcdList || []; t = i.removeBCD(t, "make"), t = i.removeBCD(t, "model"), t = i.removeBCD(t, "variant"), e.bcdList = t, o.setLocalStorageItem("GaadiData", e) } else { let t = e.bcdList || []; t = i.removeBCD(t, "make"), t = i.removeBCD(t, "period"), t = i.removeBCD(t, "model"), t = i.removeBCD(t, "variant"), e.bcdList = t, o.setLocalStorageItem("GaadiData", e) } } closeModal() { const e = o.getLocalStorageItem("GaadiData") || {}; l.publish("gaadi-wc.iframeClosed", e), this.shadowRoot.querySelector(".modal").classList.toggle("show-modal") } } customElements.define("pop-up-widget", u); class m extends HTMLElement { constructor() { super(); const e = this.attachShadow({ mode: "open" }), t = i.createTemplate('\n    <style>@import url(\'../../webcomponent/sellcar-widget/components/thank-you/thank-you-widget.css\');</style>\n    <div class="sellThankyouWidget">\n        <h1 class="mainHeadingText">Thank you!</h1>\n        <h2 class="mainSubHeadingText">Our team will get in touch with you soon.</h2>\n        <div class="brandImageBottom">\n            <img src="https://stimg.cardekho.com/pwa/img/ucrN/aK.png" alt="brand image" />\n        </div>\n    </div>').content.cloneNode(!0); e.appendChild(t) } connectedCallback() { o.getLocalStorageItem("GaadiData") } } customElements.define("thank-you-widget", m); class p extends HTMLElement { constructor() { super(); const e = this.attachShadow({ mode: "open" }); o.getLocalStorageItem("GaadiData"); const t = i.createTemplate('\n    <style>\n    @import url(\'../../../../../gaadi/webcomponent/sellcar-widget/css/style.css\');\n    </style>\n    <div class="sellCarWidget">\n    <div class="topContainerText">\n        <h1 class="mainHeading">Book Home Inspection to get the <strong class="greenText">Best price*</strong></h1>\n        <div class="brandImage">\n            <img src="https://stimg.cardekho.com/pwa/img/ucrN/cardekhoAk_sm.png" alt="brand image"/>\n        </div>\n    </div>\n    <button type="button" name="checkPrice" class="CTAButton" id="bookNow">Book Now</button>\n</div>\n    ').content.cloneNode(!0); e.appendChild(t), this.handleBookNow = this.handleBookNow.bind(this), this.shadowRoot.querySelector("#bookNow").addEventListener("click", () => this.handleBookNow()) } handleBookNow() { l.publish("gaadi-wc.apptdropopen", {}) } isYearSameInBookedAppointment() { let e = !1, t = o.getLocalStorageItem("GaadiData") || {}; if (t && t.bookedAppointment && t.bookedAppointment.Vehicle_Detail && t.bookedAppointment.Vehicle_Detail.year_id) { e = t.year_id == t.bookedAppointment.Vehicle_Detail.year_id } return e } } customElements.define("appointment-drop-widget", p); let h = ""; class g extends HTMLElement { constructor() { super(); this.attachShadow({ mode: "open" }); l.subscribe("gaadi-wc.invalidRegNo", e => this.openPopup(e)) } openPopup(e) { console.log("data", e), h = e; const t = i.createTemplate('\n<style>@import url(\'../../webcomponent/sellcar-widget/components/invalid-vehicle-alert/invalid-vehicle-widget.css\');</style>\n<div class="modal">\n  <div class="modal-content">\n      <div class="modelHeaderSection">\n          <div class="crossButton" id="closeButton">×</div>\n      </div>\n      <div class="modelBodySection">\n      <h2 class="popupHeading" id="modelBodySection"></h2>\n        <div class="rejNumber">\n            <span id="showRegNo"><span>\n            <div class="changeNumberCTA">Change</div>\n        </div>\n      </div>\n  </div>\n</div>').content.cloneNode(!0); this.shadowRoot.appendChild(t), this.shadowRoot.querySelector(".modal").classList.toggle("show-modal"), this.shadowRoot.querySelector("#modelBodySection").innerHTML = e.message, this.shadowRoot.querySelector("span").innerHTML = e.registrationNo } connectedCallback() { } } customElements.define("invalid-vehicle-widget", g); class v extends HTMLElement { constructor() { super(); this.attachShadow({ mode: "open" }); const e = i.createTemplate('\n    <style>\n    @import url(\'../../../../../gaadi/webcomponent/sellcar-widget/css/style.css\');\n    </style>\n    <div class="sellCarWidget">\n        <div class="topContainerText">\n            <h1 class="mainHeading">Sell your car at the <strong class="greenText">Best price*</strong></h1>\n            <div class="brandImage">\n                <img src="https://stimg.cardekho.com/pwa/img/ucrN/cardekhoAk_sm.png" alt="brand image"/>\n            </div>\n        </div>\n        <div id="mainContainer">\n            <reg-input-widget></reg-input-widget>\n            <invalid-vehicle-widget></invalid-vehicle-widget>\n            <pop-up-widget show="false"></pop-up-widget>\n        </div>\n    </div>\n    ').content.cloneNode(!0); this.shadowRoot.appendChild(e) } } customElements.define("home-widget", v); let y = "default", f = "dropoff", w = "apptsuccess"; const S = { userName: "userName", mobileNo: "mobileNo", citymid: "citymid", isVerified: "isVerified", env: "env", cityname: "cityname" }; class b extends HTMLElement { constructor() { super(); this.attachShadow({ mode: "open" }); this.activeTemplate = this.getTemplateBasedOnGaadiData(), this.render() } render() { let e = `\n        <style>\n        @import url('../../webcomponent/sellcar-widget/css/style.css');\n        </style>\n        <div>\n            ${this.activeTemplate == y ? '<home-widget show="false"></home-widget>' : ""}\n            ${this.activeTemplate == f ? "<appointment-drop-widget id='appt-drop-widget' show='false'></appointment-drop-widget>" : ""}\n            ${this.activeTemplate == w ? "<thank-you-widget id='thanks-widget' show='false'></thank-you-widget>" : ""}\n            <pop-up-widget></pop-up-widget>\n        </div>\n        `; console.log(e), this.shadowRoot.innerHTML = e } getTemplateBasedOnGaadiData() { let e = y, t = o.getLocalStorageItem("GaadiData") || {}, a = t.bookedAppointment || {}, i = !(!a || !a.ref_code); return e = t && i ? w : t && t.variantId ? f : y, e } renderOnClose() { this.activeTemplate = this.getTemplateBasedOnGaadiData(), this.render() } connectedCallback() { let e = this; l.subscribe("gaadi-wc.iframeClosed", e => this.renderOnClose(e)); let t = {}; Object.keys(S).forEach(a => { t[a] = e.shadowRoot.host.getAttribute(S[a]) }); let a = o.getLocalStorageItem("GaadiData") || {}; a.userName = t[S.userName], a.mobileNo = t[S.mobileNo]; let n = t[S.citymid], r = t[S.cityname]; if (n && r) { let e = { id: n, value: r }; i.setcitySessionCookie(e) } } } customElements.define("cross-sell-widget", b) }]);